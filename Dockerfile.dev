# Dockerfile.dev for Divergent Flow API (development/watch mode)
FROM node:20-alpine

WORKDIR /usr/src/app

# Copy the whole monorepo for local dev (context will be set to monorepo root)
WORKDIR /monorepo
COPY . .
WORKDIR /monorepo/packages/div-flo-api
ENV NODE_ENV=development
RUN npm install
RUN npm install -g nodemon ts-node typescript

ENV NODE_ENV=development

# Expose the default API port (override in compose if needed)
EXPOSE 3001

# Start with nodemon for hot-reload
CMD ["nodemon", "src/server.ts"]
